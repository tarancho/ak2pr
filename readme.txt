-*- mode: text; coding: sjis-dos -*-
Time-stamp: <2004-12-23 17:16:39 tfuruka1>
$Id: readme.txt,v 1.10 2004/12/23 08:17:28 tfuruka1 Exp $
$Name:  $


       テキストファイル印刷ツール「ak2ps のようなもの」 Ver. 2.4
                    〜とっても不親切なマニュアル〜

                              T.Furukawa
                          tfuruka1@nifty.com

●機能概要
==========

本ツールは, コマンドラインから*も*使用可能なテキストファイルを印刷する
為のツールです。*も*なので, GUI でも使用する事が可能です。

●機能説明
==========

本ツールは, テキストファイルを印刷するツールです。似たようなツールは沢
山あると思いますが, 大きな(小さなかも)特徴は,

        ◎ コマンドラインから使用できる

        ◎ 標準入力から読み込んだ内容を印字できる

        ◎ でも, GUI でも使用できる

です。元々は, Emacs(Meadow)から使用する事を目的として作成しましたので,

        ◎ Emacs の print-buffer, lpr-buffer 等と連携できる

        ◎ Emacs の ps-print-buffer, ps-print-buffer-with-faces 等と連
           携して非 PostScript プリンターでの印刷が可能。但し, 別途
           GhostScript 又は, Acrobat Distiller 等のソフトウエアが必要
           になります

        ◎ Emacs 上で動作するメーラーである Mew の印刷機能と連携できる

等の特徴があります。また, Emacs なんて使ってないよ。コマンドラインから
は使いにくいよ。という方の為(っていうか, 自分の為ですけど・・・)に

        ◎ GUI でも使用可能

        ◎クリップボードの内容も印刷可能

        ◎ ドラッグ&ドロップで印刷可能

となっています。特に, 大量にテキストファイルを印刷する必要がある時は,
フォルダ毎, ドラッグアンドドロップする事で, フォルダに含まれている全て
のファイルを印刷する事も可能です。それなりに細かいフォーマットの設定も
行う事ができます。

        ● タブ幅の指定

        ● フォントサイズの指定

        ● プレビュー機能(後から追加したので・・・ですが)

        ● 段組印刷(一応無限大・・・ 3段を超えると読みにくいでしょう)

        ● 行番号の On/Off

等の機能を実装してしていますので, Emacs からだけではなく, 普通のテキス
ト印刷ツールとしても, それなりには使えると思います。


●動作環境
==========

一応, Windows(32bit)汎用です。

最初は, Windows NT 3.51で作り始めたんですが, 現在は環境が無いので, 試
せません。多分, 3.51ではもはや動作しないと思いますが, その他の Windows
では多分, 動作すると思います。因みに私の環境は, Windows NT 4.0です(今
は Windows Xp です)。

●歴史
======

「ak2ps のようなもの」の名称の通り, a2ps と同じような事が出来る事を目
標として作成し始めました。といっても, a2ps もどんどん Version up して
いるので, 現在の a2ps とはかなり異なったものになっていると思います。

私が, UNIX を使用していた頃は, テキストファイルの印刷はもっぱら, a2ps
を使用していました。a2ps では, 日本語を印刷できないので, 自分で, 日本
語対応及び所謂半角カタカナを印刷できるように修正して ak2ps と改名して
使用していました(ただ, 当然, 同じ事を考える人は居るもので, 既に a2ps
は日本語化されていましたし, 名称も ak2ps で全く同じというのもありまし
た)。

そのうち, 私も Windows を使用するようになったのですが, エディタは相変
わらず, Emacs を使用していました(勿論現在も)。印刷も PostScript プリン
タを使用できる環境にあったので, UNIX の ak2ps を Windows 上でコンパイ
ルして, (ごく僅かな修正を施して)そのまま使用していました。

暫くして, PostScript プリンタを使用出来る環境には居られなくなってしま
いました。暫くは, GhostScript を使用して ak2ps を使用していたのですが,
やっぱり, 少々不便に感じるようになってきました。

そこで, フリーの印刷ツールを探してみたのですが, 殆どが GUI から使用す
るものばかりで, Emacs から簡単に使用できそうなものは見つかりませんでし
た(現在はそれなりに有りますね)。

そんなわけで, このツールの制作にかかったのですが, 作り始めてから公開す
るに至るまで, 実に 5年弱の月日が経過してしまいました(ただ単に, 公開す
るつもりがあまり無かっただけなんですけど)。その間に, RCS が吹っ飛んだ
りして修正履歴が分からなくなってしまった部分もあります。

●インストール方法
==================

以下のファイルを同一の(新規)フォルダに格納して下さい。

        ak2pr.dll       - 共通ダイナミックリンクライブラリ
        ak2prSV.exe     - 印刷サーバ
        ak2pr.exe       - コマンドライン用ツール
        ak2prW.exe      - コマンドライン用ツール(コンソール無し)

頻繁にコマンドラインから使用する方は, PATH が張られているフォルダに格
納する事をお勧めします。

●アンインストール方法
======================

インストール時に作成したフォルダを(中のファイル毎)削除して下さい。

●使用方法
==========

    ●最初に行う事
    ==============

    最初に ak2prSV.exe を Explorer 等から起動して下さい。一番, 最初の
    起動に限り, 起動時に「プリンタの設定」ダイアログが表示されますので,
    プリンタの設定を行い, 「OK」ボタンをクリックして下さい。

    タスクバーの右側に見慣れないアイコンが, 表示されますが, これが, 本
    ツールの印刷屋さんです。

    アイコンをダブルクリックすると, メインウインドウが表示されます。こ
    のメインウインドウに印刷したいファイルをドロップする事で, 印刷を行
    う事が出来ます。

    アイコンにマウスカーソルを合わせて, 右ボタンをクリックすると, メ
    ニューが表示されます。ちなみに, このメニューと, メインウインドウの
    「唯一のメニュー」メニューの内容は全く同一のものです。また, メイン
    ウインドのツールバーの内容もメニューと全く同じです。

    全ての印刷は, ak2prSV.exe が受け持ちます。

    ●起動オプション
    ================

    以下に ak2prSV の起動オプションを示します。

    ak2prSV [-S]

    -S ak2pr を「印刷停止」状態で起動します。尚, Version 2.1以前では,
       起動時は常に「印刷停止」状態になるようになっていましたが, 2.1以
       降は本オプションを指定しない限りは, 印刷可能状態で起動します。
       私が, 間違えて, 無意味なファイルを大量印刷するのを抑止する為に
       のみに本オプションは存在します。(^^;このオプションは, ak2prSV
       を一番最初に起動したときのみ有効になります。ak2prSV が既に起動
       している状態の時に指定しても無視します(ak2prSV は複数起動できま
       せん)。

    ●印刷スタイルの設定
    ====================

        印刷スタイルの設定は, メニューの「ページ設定...」又は, 「ドラ
        イバーとペンチ」の絵が描画されているツールボタンを押下して行い
        ます。「共通設定」, 「e-mail 印刷」, 「テキスト印刷」,
        「PostScript」のタブを持ったダイアログが表示されます。それぞれ
        のタブで設定できる事を以下に記述します。

        ●「共通設定」タブ
        ==================

        フォントサイズ  フォントサイズの設定を行います。デフォルトは 10
                        ポイントになっています。

        段組数          段組数の設定を行います。デフォルトは 2段組になっ
                        ています。

        タブ幅          タブ幅の設定を行います。デフォルトは, 8になっ
                        ています。

        Default         このボタンをクリックすると, デフォルトの設定を
                        行います。

        フォント名(本文)
        フォント名(タイトル)
        フォント名(行番号)
        フォント名(その他)

                        それぞれの印刷で使用するフォント名を指定します。
                        デフォルトはそれぞれ, 「MS P 明朝」, 「MS P ゴ
                        シック」, 「Courier New」, 「Arial」です。選択
                        理由は以下の通りです。

                        本文のフォントは, 日本語と欧文が混在している可
                        能性が高いと思いますので, 等幅フォントをデフォ
                        ルトで選択しています。タイトルに使用するフォン
                        とは少し目立ちそうなプロポーショナルフォントを
                        選択しています。行番号は, 本文と同様, レイアウ
                        トが崩れないように等幅フォントを選択しています。
                        その他(ページ番号等)は日本語が含まれる事はあま
                        り無いと思いましたので, 欧文のプロポーショナル
                        フォントを選択しました。

                        ご自分の好みに合うフォントを選択して下さい。但
                        し, 本文に日本語が含まれているのに, 欧文フォン
                        トを選択してしまうと, 印刷しても日本語が印刷さ
                        れなくなりますので, ご注意下さい。

                        因みに現在のところ, フォント名に関する設定は,
                        コマンドラインから行う事は少ないと思いましたの
                        で, ak2pr や ak2prW からは設定する事は出来ませ
                        ん。

        プレビュー確認後印刷する このチェックボックスがチェックされて
                        いる状態の場合は, プレビュー画面が表示されます。
                        このチェックボックスがチェックされていない場合
                        は, 直ちに印刷を行います。

                        ●プレビュー画面で出来る事
                        ==========================

                        プレビュー画面で出来る事を以下に記述します。

                        印刷            Print ボタンを押下すると, プレ
                                        ビュー画面を閉じて印刷を開始し
                                        ます。

                        印刷設定        Setup ボタンを押下すると, 印刷
                                        スタイルの設定を行う事が出来ま
                                        す。設定内容は, 「印刷スタイル
                                        の設定」を参照して下さい(ドキュ
                                        メントが無限ループしちゃってい
                                        ますね(^^;)。印刷設定が完了す
                                        ると, 再度プレビュー画面になり
                                        ます。

                        破棄            Cancel ボタンを押下すると, プレ
                                        ビュー画面を閉じます。印刷ドキュ
                                        メントは破棄します。

        COPYRIGHT を印刷しない  このチェックボックスがチェックされてい
                        る状態で印刷を行った場合は, 控えめに印字してい
                        る COPYRIGHT を印字しません。チェックされていな
                        い場合は, 控えめに COPYRIGHT を印字します。

        短辺綴          短辺綴で印刷する場合は, このチェックボックスを
                        チェック状態に設定して下さい。デフォルトは長辺
                        綴です。

        デバッグ用の印刷  私用のチェックボックスです。

        Printer         このボタンをクリックすると, プリンタの設定ダイ
                        アログが表示されます。プリンタの設定を行って下
                        さい。

        ●「e-mail 印刷」タブ
        ====================

        このタブで設定できる内容は, 実は, Emacs 上の Mew から印刷された時
        の事を考慮しています。Emacs で Mew を使用しない方は読み飛ばして下
        さい。

        カラー印刷      このチェックボックスがチェックされている場合,
                        カラーで印刷します。

        簡易ヘッダ印刷 このチェックボックスがチェックされている場合,
                        メールヘッダの Receive ヘッダを印刷しません。最
                        近の Mew は デフォルトで Receive ヘッダ等を印
                        刷に渡さなくなっていますので, あまり意味を成さ
                        なくなってしまいました。

        ●「テキスト印刷」タブ
        ======================

        このタブでテキスト印刷時の書式を設定します。このタブで設定した
        内容はe-mail印刷にも反映されます。

        行間の設定

            日本語に合わせる

                このラジオボタンをチェック状態にすると、行間を日本語を
                含むテキストを印刷する場合に読みやすい行間に設定します。
                欧文の設定より、やや広い行間になります。

            欧文に合わせる

                このラジオボタンをチェック状態にすると、欧文のみのテキ
                ストを印刷する場合に読みやすい行間に設定します。

            兎に角沢山詰め込む

                このラジオボタンをチェック状態にすると、可能な限り（文
                字が重ならない範囲で）行間を詰めます。

            自動判別

                このラジオボタンをチェック状態にすると、テキストを判別
                し、行間を設定します。

        その他の設定

            行番号を付ける

                このチェックボックスをチェック状態にすると, 行番号を印
                刷します。チェックを外すと, 行番号の印刷を行わなくなり
                ます。ただし, この設定よりも, ak2pr, ak2prW の -n[-]
                オプションの方を優先します。

            罫線を連結する

                このチェックボックスをチェック状態にすると、罫線文字を
                含む行を印刷する時に行間を詰めて、罫線を連結して印刷し
                ます。

        ●「PostScript」タブ
        ====================

        このタブで設定できる内容は, Emacs で ps-print-buffer 等を使用した
        時に有効になりますので, Emacs を使用しない方は読み飛ばして下さ
        い。

        Acrobat 関連

            PostScript ファイルを Acrobat Distiller を使用してPDF へ変
            換する場合は, 設定して下さい。Acrobat Distiller の監視フォ
            ルダの[In]フォルダをフルパスで指定して下さい。ak2psSv.exe
            は, ただたんにそのフォルダへファイルを格納するだけです。

        GhostScript 関連

            PostScript ファイルを GhostScript で印刷する方は指定して下
            さい。GhostScript のフルパスと, そのときのオプションを指定
            して下さい。Default ボタンを押下すると, デフォルトのオプショ
            ンを設定します。プレビュー後, 印刷を行い方は, GhostView を
            指定してみても面白いと思います(私は良く使用しています)。

    ●クリップボード印刷
    ====================

    メニューの「クリップボード印刷」又は, 「クリップ」の絵のツールボタ
    ンを押下すると, クリップボードの内容を印刷します(正確には, 印刷要
    求を行う)。Ctrl キーを押下した状態で, V キーを押下しても同様の事を
    行います(実は Ctrl-Y でも・・・私がよく間違えるので・・・)。

    ●テスト印刷
    ============

    メニューの「テスト印刷」又は, 「テスト用紙」の絵のツールボタンを押
    下すると, テスト印刷を行います(正確には, 印刷要求を行う)。

    ●印刷停止(再開)
    ==================

    メニューの「印刷停止」又は, 「止まれの標識」の絵のツールボタンを押
    下すると, 印刷の停止又は再開を行います。

    ●印刷 Queue の削除
    =================

    メインウインドウのリストビューで, 対象データを選択状態にして, メ
    ニューの「印刷 Queue の削除」又は, 「リサイクルボックス」の絵のツー
    ルボタンを押下すると, 印刷対象データが削除されます。

    ●作者を励ます
    ==============

    メニューの「いろいろ」→「励ましのお便り」又は, 「封書」の絵のツー
    ルボタンを押下すると, 作者に励ましのお便りをだす事ができます。もち
    ろんバグ報告等も OK です。但し, あまり, 苛めないで下さい。

    ●作者のホームページ
    ====================

    メニューの「いろいろ」→「作者のホームページ」又は, 「F」の絵のツー
    ルボタンを押下すると, 作者のホームページが見れるかもしれません。

    ●作者以外は必要の無い機能
    ==========================

    メニューの「Debug」→「詳細ウインドウ」又は, 「変な顔」の絵のツー
    ルボタンを押下すると, 作者以外には必要の無いウインドウが表示されま
    す。

    ●終了
    ======

    メニューの「終了」又は, 「非常口」の絵のツールボタンを押下すると,
    本ツールを終了する事ができます。

    ●プレビュー画面で出来る事
    ==========================

    「印刷スタイルの設定→共通設定」タブで, 「プレビュー確認後印刷する」
    のチェックを付けている場合, 印刷する前にプレビュー画面が表示されま
    す。「Print」, 「Setup」, 「Cancel」の三つのボタンと印刷イメージが
    表示されます。そのまま印刷する場合は「Print」を押下します。印刷を
    取り消す場合は「Cancel」を押下します。レイアウトを変更する場合は
    「Setup」を押下して下さい。「Setup」を押下した時に開く画面は, 「印
    刷スタイルの設定」と同じですが, ここで設定した値は, 現在のファイル
    に*のみ*反映されます。また, 「個別設定」のタブが追加されています。
    このタブでは, 印刷タイトルを変更する事が出来ます。

●印刷する(GUI)
===============

・ 印刷したいファイルを Explorer で選択し, ak2prSV.exe のメインウインドウ
   にドラッグ&ドロップして下さい。フォルダをドロップした場合は, フォ
   ルダに含まれる全てのファイルを印刷します。

・ ak2prSV のメニューから「クリップボード印刷」を選択すると, クリップボー
   ドの内容の印刷を行います。ツールバーの「クリップ」の絵をクリックし
   ても同様の事が行えます。さらに Ctrl-V でも可能です。ついでに Ctrl-Y で
   も OK です。

●コマンドラインから印刷する
============================

コマンドラインから印刷する場合も, ak2prSV.exe が起動されている必要があ
りますので, 先に ak2prSV.exe を起動しておいて下さい(一応, ak2pr.exe,
ak2prW.exe から自動起動できるように作成していますが, 上手く起動できない
場合があります---最近はこの問題は出にくくなっています)。

コマンドラインから印刷する場合は, ak2pr.exe 又は ak2prW.exe を使用します。
これらのコマンドは, 標準入力から印刷データを読み取る事も出来ます。但し,
ak2prW.exe は, コンソールを持っていませんので, 特殊な環境下以外(標準入
力を ak2prW.exe に与える環境以外)では, 標準入力データを印刷する事は出来
ません。ak2pr.exe と ak2prW.exe の違いは, コンソールを持っているか, 持っ
ていないかだけです。

以下の使用方法を記述します。ak2pr.exe, ak2prW.exe 共に同様です。以下の
記述に「デフォルトはサーバの設定」が多数ありますが, これは,
ak2prSV.exe のページ設定で行った内容という意味です。

Usage: ak2prW [-o{p|l}] [-m{PLAIN|MAIL|PS_ACROBAT|PS_GHOST}]
        [-f フォントサイズ] [-t タブ幅] [-u 段組数] [-T タイトル]
        [-J タイトル] [-s 用紙サイズ] [-P] [-b{s|l}] [ファイル名...]

    -o 用紙の向きを指定します。デフォルトはサーバの設定。
        p PORTRAIT
        l LANDSCAPE
    -m ファイルの種類を指定します。デフォルトはサーバの設定。
        PLAIN      プレーンテキストファイル
        MAIL       インターネットメール(SJIS)
        PS_ACROBAT PostScript ファイル(Acrobat Distiller で変換)
        PS_GHOST   PostScript ファイル(GhostScript で印刷)
    -f フォントサイズを指定します。デフォルトはサーバの設定。
    -t タブ幅を指定します。デフォルトはサーバの設定。
    -u 段組数を指定します。デフォルトはサーバの設定。
    -T タイトルを指定します(-J と同じ)。デフォルトはファイル名。
    -J タイトルを指定します(-T と同じ)。デフォルトはファイル名。
    -s 用紙サイズを指定します。デフォルトはサーバの設定。
    -n[-] 行番号を印字します。-n-を指定した場合は, 行番号を印刷しませ
          ん。このオプションを指定しなかった場合は, サーバの設定に従い
          ます。
    -P 指定しても何もしません。
    -S サーバを起動する時に印刷停止状態で起動します。サーバが既に起動
       している場合は意味を持ちません。
    -b 長辺綴じ・短辺綴じを指定します。デフォルトはサーバの設定。
         s 短辺綴じ
         l 長辺綴じ
    ファイル名 印刷するファイル名を指定します。
        指定しなかった場合は, 標準入力から読み込みます。
        複数ファイル指定できます。
--
用紙サイズは以下の何れかを指定して下さい。但し, 全てのオプションが全て
のプリンタで有効とは限りません。

オプション          説明
------------------- ------------------------------
A3                  A3シート, 297× 420ミリメートル
A4                  A4シート, 210× 297ミリメートル
A4SMALL             A4 small シート, 210× 297ミリメートル
A5                  A5シート, 148× 210ミリメートル
B4                  B4シート, 250× 354ミリメートル
B5                  B5シート, 182× 257ミリメートル
LETTER              Letter, 8 1/2× 11インチ
LEGAL               Legal, 8 1/2× 14インチ
CSHEET              C シート, 17× 22インチ
DSHEET              D シート, 22× 34インチ
ESHEET              E シート, 34× 44インチ
LETTERSMALL         Letter Small, 8 1/2× 11インチ
TABLOID             Tabloid, 11× 17インチ
LEDGER              Ledger, 17× 11インチ
STATEMENT           Statement, 5 1/2× 8 1/2インチ
EXECUTIVE           Executive, 7 1/4× 10 1/2インチ
FOLIO               Folio, 8 1/2× 13インチ
QUARTO              Quarto, 215× 275ミリメートル
10X14               10× 14インチシート
11X17               11× 17インチシート
NOTE                Note, 8 1/2× 11インチ
ENV_9               #9 Envelope, 3 7/8× 8 7/8インチ
ENV_10              #10 Envelope, 4 1/8× 9 1/2インチ
ENV_11              #11 Envelope, 4 1/2× 10 3/8インチ
ENV_12              #12 Envelope, 4 3/4× 11インチ
ENV_14              #14 Envelope, 5× 11 1/2インチ
ENV_DL              DL Envelope, 110× 220ミリメートル
ENV_C5              C5 Envelope, 162× 229ミリメートル
ENV_C3              C3 Envelope, 324× 458ミリメートル
ENV_C4              C4 Envelope, 229× 324ミリメートル
ENV_C6              C6 Envelope, 114× 162ミリメートル
ENV_C65             C65 Envelope, 114× 229ミリメートル
ENV_B4              B4 Envelope, 250× 353ミリメートル
ENV_B5              B5 Envelope, 176× 250ミリメートル
ENV_B6              B6 Envelope, 176× 125ミリメートル
ENV_ITALY           Italy Envelope, 110× 230ミリメートル
ENV_MONARCH         Monarch Envelope, 3 7/8× 7 1/2インチ
ENV_PERSONAL        6 3/4 Envelope, 3 5/8× 6 1/2インチ
FANFOLD_US          US Std Fanfold, 14 7/8× 11インチ
FANFOLD_STD_GERMAN  German Std Fanfold, 8 1/2× 12インチ
FANFOLD_LGL_GERMAN  German Legal Fanfold, 8 1/2× 13インチ

● Emacs(Meadow)から印刷する
=============================

    ● Emacs のバッファの内容を印刷する
    =================================

    Emacs のバッファの内容を印刷する場合は, 通常通り, lpr-buffer,
    print-buffer, lpr-region, print-region 等から印刷できます。但し,
    .emacs 等で以下の設定を行って下さい。

      (setq lpr-command
            (expand-file-name (concat exec-directory
                                      "../../site-bin/ak2pr.exe")))
      (setq lpr-switches '())
      (setq lpr-add-switches t)
      (setq lpr-command-switches '())

    lpr-command で ak2pr.exe の場所を指定します。上記の例は, Meadow のイ
    ンストールフォルダの直下に site-bin というフォルダを作成して, そこに
    本ツールをインストールした場合の例です。

      Meadow
      ├─ 1.15
      │  ├─ bin        ← ここが exec-directory
      │  ├─ data
      │  ├─ etc
      │  ├─ info
      │  ├─ leim
      │  ├─ lisp
      │  ├─ lock
      │  └─ site-lisp
      ├─ site-bin       ←ここにインストールした例
      ├─ site-info
      └─ site-lisp

    ak2pr のオプションを固定で指定する場合は, lpr-switches に指定しま
    す。例えば, 常に用紙を横置き, フォントサイズを 9ポイント, 二段組,
    用紙サイズを A4, 長辺綴じに設定する場合は以下のように設定します。

        (setq lpr-switches '("-ol" "-f9" "-u2" "-sA4" "-bl"))

    私のように, 間違えて意味のない用紙を沢山出力してしまう方は, -S オ
    プションを常に指定しておくと良いでしょう(そんな奴は居ないって)。

        (setq lpr-switches '("-S"))

    ● Emacs のバッファの内容を印刷する(PostScript)
    =============================================

    Emacs の ps-print-buffer, ps-print-buffer-with-faces,
    ps-print-region, ps-print-region-with-faces を使用して非 PostScript
    プリンタで印刷を行う事も可能です。その場合は, 上記の例で,
    lpr-command の設定を行っている事が前提ですが, 更に以下の設定を
    .emacs 等で行って下さい。

    (setq ps-multibyte-buffer 'non-latin-printer ;マルチバイト印刷を行う
          ps-line-number t                  ;行番号を印刷する
          ps-paper-type 'a4                 ;用紙サイズは A4
          ps-landscape-mode t               ;用紙は横置き
          ps-number-of-columns 2            ;2段組
          ps-lpr-command lpr-command        ;lpr と同じ
          ps-lpr-switches '("-mPS_GHOST")   ;GhostScript に処理させる
          )

    ps-lpr-switches の設定を "-mPS_ACROBAT" に変更する事により, Acrobat
    Distiller で処理させる事も可能です。又, 他の PostScript の設定に関し
    ては, 関連ドキュメント等を参照して下さい。

    ● Emacs 上の Mew から印刷を行う
    ============================

    通常通り, Mew から mew-summary-print で印刷を行う事が出来ます。以下の
    設定を.emacs 等で行って下さい。

      (setq mew-print-command-format
            (expand-file-name (concat exec-directory
                                      "../../site-bin/ak2pr.exe -mMAIL")))
      (defun mew-print-region (begin end)
        (interactive "r")
        (shell-command-on-region begin end mew-print-command-format))

      (defun mew-print-buffer ()
        (interactive)
        (mew-print-region (point-min) (point-max)))

      (setq mew-print-function (function mew-print-buffer))

    この設定の詳細については, Mew の FAQ 等を参照して下さい。この設定
    で ak2pr の設定を mew-print-command-format に行っています。インストー
    ルする位置によって, 設定内容は異なります。詳しくは, 「Emacs のバッ
    ファの内容を印刷する」を参照してください。

    Mew で印刷を行った場合, Message-ID が常に「わかりまへん」と印刷さ
    れる場合は, *scratch*バッファで

        mew-field-for-printing

    を確認してみてください。その結果に Message-ID: が含まれていない場
    合は, 上記のような現象になります。デフォルトでは,

        ("Subject:" "From:" "To:" "Cc:" "Date:")

    になっていると思いますので, その場合は, .emacs 等で
    mew-field-for-printing を再定義して下さい。例えば,

        (setq mew-field-for-printing
              '("Subject:" "From:" "To:" "Cc:" "Date:" "Message-ID:"))

    等としたり, あるは,

        (if (not (member "Message-ID:" mew-field-for-printing))
            (setq mew-field-for-printing
                  (cons "Message-ID:"
                        mew-field-for-printing)))

    等と定義する事によって, Message-ID が印刷されるようになります。

●著作権, 免責等
================

本ツールは, フリーソフトウエアです。入手したアーカイブのままの形式であ
れば, 再頒布, 転載は可能とします。但し, このソフトウエアを使用した事に
よって発生した損害等は, 如何なる場合においても, 作者には責任は無い事と
します。個人の責任において使用して下さい。

●バグ報告等
============

バグ報告, 改善案(あるいは, 自分で改善した), 質問等ありましたら, 是非
作者へ「励ましのお便り」(^^;を送って下さい。特にご自分で改善なさった場
合は, 私も恩恵に預かりたいので, 是非教えて下さい。

メールアドレスは, 以下の通りです。

        tfuruka1@nifty.com

改善案のご連絡を下さっても, 仕事に忙殺されている関係上, ご希望に添える
事は出来ないかもしれませんが, 言うだけは, ただですので・・・(^^;

●雑多な事
==========

本ツールは, 環境変数 TEMP で指定されたフォルダの下に「ak2prTempDir0」と
いう名称のフォルダを作成し, その下に作業ファイルを作成します。これらの
ファイルは, ak2prSV.exe が終了する時に全て削除される筈ですが, もし, 残っ
ている場合は, 「ak2prTempDir0」フォルダ毎, 削除して下さい。また, ファ
イルが残る現象を再現できる場合は, 再現方法をメールでお知らせ下さい。

コンパイル方法については, 特に記述致しません。私は VC6.0でコンパイルし
ていますが, 多分, もっと低い Version でも大丈夫だと思います。

        nmake

だけで, コンパイル出来る筈です。

ん〜っと。ak2pr.dll が何故, 存在するかというと, 一応, ak2pr.exe や,
ak2prW.exe のようなクライアント(と呼んで良いかは別として)ツールが簡単
に作成できるようにしているんです。ak2pr.dll で定義している API を使用
して, その時々に応じた印刷ツールを簡単に作成出来るように・・・というの
が, 最初の目的でした(一応, 今もそのつもりなんですけど)。

一部, デバッグ用に Syslog 出力しています。Syslogd を起動している方は, ご
注意(べつに悪さは与えないと思いますが)ください。

●更新履歴
==========

  ★ Ver. 2.5 2004/mm/dd

     ・ シングルライン印刷(ようするに, 右側に文字が食み出した部分は印
        刷されない)に対応しました。

     ・ 細かい事ですが, GhostScript の実行ファイルをファイル選択ダイア
        ログボックスから選択できるようにしました。

  ★ Ver. 2.4 2004/08/30

     ・ メール印刷したときに, ヘッダの 2行目以降が文字化けする問題を修
        正しました。

     ・ テキスト印刷で, 行間の設定と, 罫線の連結が出来るようになりまし
        た。

     ・ メール印刷の時に, ヘッダ部とボディ部の区切りを「--------」(ハ
        イフォン 8つ)でも認識するようにしました(MH 形式のメッセージに
        も対応出来るようにしました)。

     ・ メール印刷で罫線が連結しない場合がある問題を修正しました。罫線
        文字が現れる前に 2バイト文字があると罫線が連結していませんでし
        た。

        古┃ ←このパターンが連結出来ていなかった
 　     ━┛

        ┃古 ←このパターンはOKだった。
        ┗━

  ★ Ver. 2.3 2004/01/24

     ・ 印刷フォントを指定出来るようにしました。

     ・ Emacs から使用する場合で, バッファ名にリダイレクト記号等が含ま
        れていると, 印刷出来なかった問題を修正しました。Ver.2.1での修
        正漏れです。

     ・ 長辺綴じと短辺綴じを指定できるようにしました(従来は長辺綴じの
        み)。平たく言うと, 「A4縦で印刷した際の上部にパンチ穴マークと
        三角印を印字出来るようになった」という事です。

     ・ 特に動作に影響は無かったのですが, Emacs の ps-print-xxxxx で印
        刷を行うときに, /D:PRN オプションをファイル名(ak2pr ではディレ
        クトリセパレータに'/'を許しています)と認識していたので, 無視す
        るようにしました。

     ・ 露見していなかったが, メモリ破壊を起こす可能性のある部分を修正
        しました。

  ★ Ver. 2.2 2003/03/29

     ・ クリップボードの内容を印刷できるようにしました。

     ・ キューイング後のドキュメントの印刷タイトルを, ページ設定で変更
        出来るようにしました。

     ・ プレビュー時に書式の再設定を出来るようにしました。プレビュー自
        体が後から追加した機能なので, あまり綺麗には実装できませんです
        たが, 取りあえず用件は満たしているかな・・・っと

     ・ PostScript ファイルを処理するときのファイル名が判りにくかったの
        で, ファイル名のベースを PostScript ファイルの「%%Title:」フィー
        ルドから得るようにしました。また, Acrobat Distiller で処理する
        ファイルに拡張子として, '.PS' を付加するようにしました。

     ・ ak2prSV の起動時に必ず「印刷停止」状態になる仕様を止めました(印
        刷可能状態にしました)。合わせて, 起動時に「印刷停止」状態にす
        る為の起動オプションを追加しました。同様に ak2pr, ak2prW にもサー
        バの起動オプション -S を追加しました。

     ・ 「印刷停止」の状態がメニューとツールボタンで一致しない事(ツー
        ルボタンの操作は, メニューに反映されるけど, メニューの操作がツー
        ルバーに反映されない)があるバグを修正しました。

     ・ ツールバーにツールチップを付けました。ま〜, あまり意味は無いん
        ですけど。

  ★ Ver. 2.1 2003/03/01

     ・ 前回のリリースを 2.0としてしまったが, 実は 1.7でした。そんなわけ
        で, 1.7から 2.1にヴァージョンアップすることにしました。

     ・ 行番号の印刷を抑止できるように -n オプションを追加しました。ま
        た, サーバ側でも「行番号」印刷の On/Off を制御できるようにしまし
        た。メールの印刷にも行番号は有効です。

     ・ Emacs から印刷するときに, *scratch* バッファのように, ファイル
        をもたないバッファで, バッファ名に * や : が含まれていると, 印
        刷が出来なかった問題を修正しました。

     ・ e-mail 印刷を少しだけカラフルにしました。

     ・ ページ設定の e-mail タブの内容がクリア(特定の手順で操作を行った
        場合)される場合があったので, 修正しました。

     ・ ページ設定の PostScript タブの内容がキャンセルを選択しても反映さ
        れてしまう問題を修正しました。

  ★ Ver. 1.7 2001/12/23
     正式公開 Version.
     これ以前の Version に関しては履歴不明

● To Do
========

いつ対応できるか・・・

・ 行をはみ出た分は印刷しないモードを追加する(2004/12/20)

・ 偶数頁と奇数頁でレイアウトをきりかえる(2004/12/20)

・ 2ぺージ目以降のプレビュー(2002/4/22)
   2ページ目以降のプレビューを可能にする。プレビュー自体, 後から追加し
   た機能なので, 実現は難しいかも・・・

・ 印刷キューのプレビュー(2003/4/15)
   要望はあるのですが・・・

・ Meadow2で印刷すると, 半角豆腐が行末に印刷される場合がある件の修正。
   多分, 行末が^M^M になっている為と思われる。(2003/8/1)→どうやら
   Meadow2と Mule-UCS の相性っぽいです。SJIS-DOS の改行コードが
   CR+CR+LF になっているようです。カレントの Mule-UCS に変えたら当該現
   象は発生しなくなりました。とりあえず ak2pr では対応しない方向ですが,
   このメモは残しておきます。
